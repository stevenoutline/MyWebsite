(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[735],{92:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/uc/channel/list",function(){return n(7372)}])},7372:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var s=n(5893),a=n(9653),i=n(8641),c=n(8981),r=n(979),l=n(3038),o=n(7741),h=n(3382),u=n(2829),d=n(5675),x=n.n(d),j=n(7294);let p=e=>{let{onCopy:t,value:n,setValue:l,hasCopied:d}=(0,a.VP)(e.url),[p,m]=(0,a.kt)(),[f,z]=j.useState(e.name),[g,w]=j.useState(""),[C,k]=j.useState(e.name),y=j.useContext(u.V),S=async()=>{let t=await fetch("http://10.7.1.102:8000/api/channel/update",{method:"POST",headers:{Authorization:"Bearer ".concat(y.token),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:f,code:e.code})}),n=await t.json();200!==n.status?w(n.msg):(k(n.data.name),m.off())},_=()=>{S()},v=()=>{z(e.name),m.off()};return(0,s.jsxs)(c.Zb,{children:[(0,s.jsx)(c.Ol,{children:(0,s.jsx)(i.X6,{size:"md",children:p?(0,s.jsxs)(r.BZ,{size:"md",children:[(0,s.jsx)(r.II,{pr:"4.5rem",value:f,onChange:e=>z(e.target.value)}),(0,s.jsxs)(r.xH,{width:"9rem",children:[(0,s.jsx)(o.zx,{h:"1.75rem",size:"sm",colorScheme:"teal",onClick:_,children:"确定"}),(0,s.jsx)(o.zx,{ml:3,h:"1.75rem",size:"sm",onClick:v,children:"取消"})]})]}):(0,s.jsxs)(s.Fragment,{children:[C," ",(0,s.jsx)(o.hU,{variant:"unstyled",ml:3,size:"sm","aria-label":"修改",onClick:m.toggle,icon:(0,s.jsx)(h.dY,{})})]})})}),(0,s.jsx)(c.eW,{children:(0,s.jsxs)(i.Kq,{divider:(0,s.jsx)(i.cX,{}),spacing:"4",children:[(0,s.jsxs)(i.xu,{children:[(0,s.jsxs)(i.X6,{size:"xs",textTransform:"uppercase",children:["推广链接"," ",(0,s.jsx)(o.hU,{variant:"unstyled",ml:3,size:"sm","aria-label":"复制",onClick:t,icon:(0,s.jsx)(h.TI,{}),color:d?"teal":"black"})]}),(0,s.jsx)(i.xv,{pt:"2",fontSize:"sm",children:e.url})]}),(0,s.jsxs)(i.xu,{children:[(0,s.jsx)(i.X6,{size:"xs",textTransform:"uppercase",children:"推广二维码"}),(0,s.jsx)(i.xv,{pt:"2",fontSize:"sm",children:(0,s.jsx)(x(),{alt:"推广二维码",src:e.qrcode,width:200,height:200})})]}),(0,s.jsxs)(i.xu,{children:[(0,s.jsx)(i.X6,{size:"xs",textTransform:"uppercase",children:"渠道统计"}),(0,s.jsx)(i.xv,{pt:"2",fontSize:"sm",children:"注册人数: ".concat(e.regCount," / 充值次数: ").concat(e.payCount,"\n              / 充值金额: ").concat(e.payTotal)})]})]})})]})},m=()=>{let[e,t]=j.useState(null),[n,h]=j.useState(""),[d,x]=(0,a.kt)(),[m,f]=j.useState(""),[z,g]=j.useState(!1),w=j.useContext(u.V),C=async()=>{let e=await fetch("http://10.7.1.102:8000/api/channel/list",{headers:{Authorization:"Bearer ".concat(w.token)}}),n=await e.json();200!==n.status?h(n.msg):t(n.data.channels)};j.useEffect(()=>{let e=async()=>{await C()};e()},[]);let k=async()=>{let e=await fetch("http://10.7.1.102:8000/api/channel/create",{method:"POST",headers:{Authorization:"Bearer ".concat(w.token),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:m})}),t=await e.json();200!==t.status?h(t.msg):(x.off(),C())},y=()=>{if(0===m.length){h("渠道名称不能为空");return}let e=async()=>{g(!0),await k(),g(!1)};e()},S=()=>{f(""),h(""),x.off()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Kq,{gap:5,children:e&&e.map(e=>(0,s.jsx)(p,{...e},e.code))}),d?(0,s.jsxs)(c.Zb,{gap:5,p:5,my:10,children:[(0,s.jsx)(r.II,{placeholder:"输入渠道名称",onChange:e=>f(e.target.value)}),n&&(0,s.jsxs)(l.bZ,{status:"error",children:[(0,s.jsx)(l.zM,{}),(0,s.jsx)(l.Cd,{children:n})]}),(0,s.jsx)(o.zx,{width:"full",colorScheme:"teal",onClick:y,children:"确定"}),(0,s.jsx)(o.zx,{width:"full",onClick:S,children:"取消"})]}):(0,s.jsx)(o.zx,{mt:10,w:"full",colorScheme:"teal",onClick:x.on,children:"新增渠道"})]})};m.Layout="uc",m.requireAuthed=!0;var f=m}},function(e){e.O(0,[376,774,888,179],function(){return e(e.s=92)}),_N_E=e.O()}]);